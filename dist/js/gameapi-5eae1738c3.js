function initHandle(){console.log("游戏加载完成"),$(".screenBtn").click(function(){$(".screenPanel").hide(),$($(this).data("target")).show(),$("#rankpanel").show(),rankstoggle()}),$(".closebar").click(function(){$("#rankpanel").hide(),$("#infopage").hide(),$(".ds_done-show").hide(),$(".reward-list-container,.dsbg").show(),$(".friendsRanks").addClass("current").siblings().removeClass("current")}),$(".tipsBtn").click(function(){$(".tipsPanel").hide(),$($(this).data("target")).show()}),$(".tipsPanel").click(function(){return!$(this).find(".tclose").length&&void $(this).hide()}),$(".tclose").click(function(){$(this).parents(".tipsPanel").hide()}),$(".itemOptimize label").click(function(){return!browser.versions.ios&&($(this).toggleClass("active"),void($(this).hasClass("active")?($(this).html("开启"),app.graphicsDevice.maxPixelRatio=1):($(this).html("关闭"),app.graphicsDevice.maxPixelRatio=window.devicePixelRatio)))}),$(".itemMusic label").click(function(){var n=app.root.findByName("player");$(this).toggleClass("active"),$(this).hasClass("active")?($(this).html("开启"),n.sound.volume=1):($(this).html("关闭"),n.sound.volume=0)}),0!=userinfo.id&&($(".btnRank").click(function(){console.log("click rank")}),rankstoggle(),"function"==typeof appInitHandle&&appInitHandle()),$(".btnShang").click(function(){$("#infopage").show()}),$(".ds_done-show").click(function(){$(this).hide(),$(".reward-list-container,.dsbg").show()}),$("#reward").click(function(){}),$(".btnGame a").click(function(n){n.preventDefault(),_hmt.push(["_trackEvent","jump","jumpToGameHall"]),window.location.href="http://www.chubao.cn/s/eventhall/index.html?v=jump"}),getallranks(),$("body>div").css("height","100%"),"function"==typeof appInitHandle&&appInitHandle(),$(".tip_img_box").click(function(){canHidePrompt&&$(".tip_img_box").hide()})}function beginHandle(){console.log("进入游戏"),$(".buttons").hide(),$("#uistart,.logo,.buttons").hide(),$(".result").show(),$("body").addClass("playing").removeClass("init"),gameStartTimestamp(),"function"==typeof appBeginHandle&&appBeginHandle()}function startHandle(){console.log("游戏开始"),$("body").addClass("playing"),$("#score").html("0"),gameStartTimestamp(),"function"==typeof appStartHandle&&appStartHandle()}function gameStartTimestamp(n){}function gameover(n){uploadRank(n.score),console.log("游戏结束"),console.log(n),$("body").removeClass("playing"),$(".buttons").addClass("ended"),$("#uiend,.buttons").show(),setGameoverShare(n),$("#score").show()}function resetHandle(){console.log("游戏重新加载"),$(".buttons").removeClass("ended"),$("body").addClass("playing"),gameStartTimestamp(3),$("#uistart,#uiend,.logo,.buttons").hide(),"function"==typeof appResetHandle&&appResetHandle()}function showmsg(n){$("#msgbox").length?($("#msgbox").show().append("<div class='item'>"+n+"</div>"),setTimeout(function(){$("#msgbox .item:first").remove(),$("#msgbox .item").length<1&&$("#msgbox").hide()},3e3)):alert(n)}function fillRanks(n){for(var e=n.length,i="",a=0;e>a;a++)if(i+='<li class="rank'+(a+1)+'">',i+='<span class="rank">'+(a+1)+"</span>",i+='<div class="pic">',i+='<img src="'+n[a].userinfo.headimgurl+'"  alt="">',i+="</div>",i+='<span class="name">'+n[a].userinfo.nickname+"</span>",i+='<span class="score">'+n[a].topscore+"</span>",i+="</li>",n[a].wxuser_id==userinfo.id){var o="";haoyouIndex||(haoyouIndex=a+1),o+='<span class="rank">'+(a+1)+"</span>",o+='<div class="pic">',o+='<img src="'+n[a].userinfo.headimgurl+'"  alt="">',o+="</div>",o+='<span class="name">'+n[a].userinfo.nickname+"</span>",o+='<span class="score">'+n[a].topscore+"</span>",$("#rankpanel").find(".myrank").html(o)}return $("#rankpanel").find("ol").html(i),i}function uploadRank(n){console.log("ready");var e="base64.php",i=Base64.encodeURI(userinfo.name);userinfo.id&&n>userinfo.topscore&&uploadBase64Score(e,{openId:userinfo.id,name:i,imgURL:userinfo.imgurl,mark:n,func:function(n){console.log(n)}})}function getallranks(){var n="fetch.php";uploadBase64Fetch(n,{openId:userinfo.id,func:function(n){var e=JSON.parse(n);console.log(e);var i="";$.each(e.dataList,function(n,e){if(console.log("my openid is "+e.Open_id),console.log("my Mark is "+e.Mark),console.log("my rank is "+e.rownum),i+='<li class="rank'+(n+1)+'">',i+='<span class="rank">'+e.rownum+"</span>",i+='<div class="pic">',i+='<img src="'+e.Img_url+'"  alt="">',i+="</div>",i+='<span class="name">'+Base64.decode(e.Name)+"</span>",i+='<span class="score">'+e.Mark+"</span>",i+="</li>",e.Open_id==userinfo.id){var a="";a+='<span class="rank">'+e.rownum+"</span>",a+='<div class="pic">',a+='<img src="'+e.Img_url+'"  alt="">',a+="</div>",a+='<span class="name">'+Base64.decode(e.Name)+"</span>",a+='<span class="score">'+e.Mark+"</span>",$("#rankpanel").find(".myrank").html(a)}e.Open_id==userinfo.id&&(userinfo.topscore=parseInt(e.Mark))}),console.log(i),$("#rankpanel").find("ol").html(i)}})}function rankstoggle(){console.log("wee"),getallranks(),_hmt.push(["_trackEvent","jump","jumpCheckBoard"])}function hideMask(){$(".share_mask").hide()}function getHaoyouNum(n){$("#myf_num").text(n)}function hideHaoyou(){$(".sort_letter").hide()}function showHaoyou(){$(".sort_letter").show()}function showMask(){$(".share_mask").show()}function showLoadding(){$(".loadding_box").show()}function hideLoadding(){$(".loadding_box").hide()}var browser={versions:function(){var n=navigator.userAgent;return navigator.appVersion,{trident:n.indexOf("Trident")>-1,presto:n.indexOf("Presto")>-1,webKit:n.indexOf("AppleWebKit")>-1,gecko:n.indexOf("Gecko")>-1&&-1==n.indexOf("KHTML"),mobile:!!n.match(/AppleWebKit.*Mobile.*/)||!!n.match(/AppleWebKit/),ios:!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:n.indexOf("Android")>-1||n.indexOf("Linux")>-1,iPhone:n.indexOf("iPhone")>-1||n.indexOf("Mac")>-1,iPad:n.indexOf("iPad")>-1,webApp:-1==n.indexOf("Safari"),QQbrw:n.indexOf("MQQBrowser")>-1,ucLowEnd:n.indexOf("UCWEB7.")>-1,ucSpecial:n.indexOf("rv:1.2.3.4")>-1,ucweb:function(){try{return parseFloat(n.match(/ucweb\d+\.\d+/gi).toString().match(/\d+\.\d+/).toString())>=8.2}catch(e){return n.indexOf("UC")>-1}}(),Symbian:n.indexOf("Symbian")>-1,ucSB:n.indexOf("Firefox/1.")>-1}}()},isloading=!1,frankstr=arankstr="",getrankstime=0,canHidePrompt=!1,gs=0,haoyouIndex=0,quanguoIndex=0,payCount=0,isPaying=!1,hasRequestDashang=!1;window.onresize=function(){window.innerHeight<window.innerWidth?(window.isPrompt?$(".tip_img_box,.show_hengping").show():$(".tip_img_box,.show_shuping").show(),canHidePrompt=!1):canHidePrompt=!0};